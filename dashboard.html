<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Urbanito Project Pulse - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.463.0/lucide.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }

        /* Custom scrollbar for agent logs */
        .agent-log::-webkit-scrollbar {
            width: 4px;
        }

        .agent-log::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
        }

        .agent-log::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-900 min-h-screen p-6 md:p-12">
    <div class="max-w-7xl mx-auto space-y-12 animate-fade-in">

        <!-- Header -->
        <header class="flex flex-col md:flex-row md:items-end justify-between gap-6">
            <div class="space-y-2">
                <a href="/"
                    class="flex items-center gap-2 text-slate-400 hover:text-indigo-600 transition-colors text-sm font-medium mb-4">
                    <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Main App
                </a>
                <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-slate-900">
                    Urbanito <span class="text-indigo-600">Sync & Status</span>
                </h1>
                <p class="text-lg text-slate-500 max-w-2xl">
                    Live tracking of active AI Agents and their current development tasks.
                </p>
            </div>
            <div
                class="flex items-center gap-3 bg-white px-4 py-2 rounded-2xl shadow-sm border border-slate-100 self-start md:self-auto">
                <div class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></div>
                <span class="text-sm font-semibold text-slate-600 uppercase tracking-wider">System Operational</span>
            </div>
        </header>

        <!-- AGENT STATUS ROW -->
        <section>
            <h2 class="text-2xl font-bold mb-6 flex items-center gap-3 text-slate-800">
                <i data-lucide="bot" class="text-indigo-600"></i> Active Agents
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="agents-container">
                <!-- Agents injected via JS -->
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Main Visual Column -->
            <div class="lg:col-span-2 space-y-8">

                <!-- Gallery -->
                <section
                    class="bg-white rounded-3xl p-8 shadow-xl border border-slate-100 overflow-hidden relative group">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-3">
                        <i data-lucide="layout" class="text-indigo-600"></i> Latest UI Previews
                    </h2>
                    <div class="relative aspect-video rounded-2xl overflow-hidden bg-slate-900 shadow-inner"
                        id="gallery-container">
                        <!-- Gallery items will be injected by JS -->
                    </div>
                    <div class="flex justify-center gap-2 mt-6" id="dots-container">
                        <!-- Dots will be injected by JS -->
                    </div>
                </section>

                <!-- Features Grid -->
                <!-- <section class="grid grid-cols-1 md:grid-cols-2 gap-4" id="features-container"> -->
                <!-- Features will be injected by JS -->
                <!-- </section> -->
            </div>

            <!-- Sidebar Column -->
            <div class="space-y-8">

                <!-- Pending Suggestions -->
                <section class="bg-white rounded-3xl p-8 shadow-lg border border-slate-100">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-3 text-amber-600">
                        <i data-lucide="lightbulb" class="w-5 h-5"></i> Pending Suggestions
                    </h2>
                    <div class="space-y-4" id="suggestions-container">
                        <!-- Injected by JS -->
                    </div>
                </section>


                <!-- Git History / Activity -->
                <section class="bg-slate-900 rounded-3xl p-8 text-white shadow-2xl relative overflow-hidden">
                    <div class="absolute -top-12 -right-12 w-48 h-48 bg-indigo-500/10 rounded-full blur-3xl"></div>
                    <h2 class="text-xl font-bold mb-8 flex items-center gap-3 relative z-10">
                        <i data-lucide="history" class="text-indigo-400"></i> Recent Commits
                    </h2>
                    <div class="space-y-6 relative z-10" id="commits-container">
                        <!-- Commits will be injected by JS -->
                    </div>
                </section>

            </div>
        </div>

        <!-- Footer -->
        <footer
            class="pt-8 border-t border-slate-200 flex flex-col md:flex-row justify-between items-center gap-4 text-slate-400 text-sm">
            <p>© 2026 Urbanito. Agent Surveillance Dashboard.</p>
        </footer>

    </div>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Skill Modal -->
    <dialog id="skill-modal"
        class="p-0 rounded-2xl shadow-2xl backdrop:bg-slate-900/50 w-[800px] max-w-full m-auto open:animate-in open:fade-in open:zoom-in-95 backdrop:backdrop-blur-sm">
        <div class="bg-white flex flex-col max-h-[80vh]">
            <div class="p-4 border-b flex items-center justify-between bg-slate-50 sticky top-0">
                <h3 class="font-bold text-lg" id="modal-title">Agent Skill</h3>
                <button onclick="document.getElementById('skill-modal').close()"
                    class="p-2 hover:bg-slate-200 rounded-full"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <div class="p-6 overflow-y-auto font-mono text-sm bg-slate-50/50 whitespace-pre-wrap" id="modal-content">
            </div>
        </div>
    </dialog>

    <script>
        // --- DATA SOURCE (Simulated from DASHBOARD.md) ---
        // ...

        // Modal Logic
        function showSkill(handle) {
            const agent = activeAgentsData.find(a => a.handle === handle);
            if (agent && agent.fullSkill) {
                document.getElementById('modal-title').innerText = agent.role + " (" + agent.handle + ")";
                document.getElementById('modal-content').innerText = agent.fullSkill;
                document.getElementById('skill-modal').showModal();
            } else {
                alert('No skill definition found for ' + handle);
            }
        }

        let activeAgentsData = [];


        const activeAgents = [
    {
        "role": "Frontend Developer",
        "handle": "@Frontend",
        "status": "active",
        "currentTask": "Waiting for tasks",
        "lastUpdate": "Specialist in React, Vite, Tailwind CSS, and Framer Motion. Responsible for implementing pixel-perfect UI, animations, and responsive layouts.",
        "fullSkill": "---\nname: frontend-developer\ndescription: Specialist in React, Vite, Tailwind CSS, and Framer Motion. Responsible for implementing pixel-perfect UI, animations, and responsive layouts.\n---\n\n# Frontend Developer Agent\n\n## Overview\nI am your Frontend Specialist. I live and breathe React components, CSS styling, and smooth transitions. If you need a button to pop, a transition to slide, or a layout to be responsive, I'm your agent.\n\n## Capabilities\n\n### 1. UI Implementation\n- I build **React Components** that are reusable and clean.\n- I use **Tailwind CSS** for efficient and consistent styling.\n- I implement **Glassmorphism** and other modern design trends as requested.\n\n### 2. UX & Interactivity\n- I adhere to the **Design Guidelines** (colors, radii, spacing).\n- I implement animations using **Framer Motion**.\n- I ensure mobile responsiveness and touch-friendliness.\n\n### 3. Code Quality\n- I refactor spaghetti code into clean, typed **TypeScript** components.\n- I manage state (Context API, Hooks) effectively.\n\n## Triggers\n- **@Frontend**: Call me when you need to build a UI, fix a styling bug, or add an animation.\n\n## Tools\n- React, Vite, Tailwind, Lucide Icons, Framer Motion.\n",
        "icon": "layout",
        "color": "text-pink-600",
        "bg": "bg-pink-50"
    },
    {
        "role": "Info Architect",
        "handle": "@InfoArchitect",
        "status": "active",
        "currentTask": "Waiting for tasks",
        "lastUpdate": "Expert in organizing complex systems, defining navigation hierarchies, and ensuring clear user flows. Focuses on \"Findability\" and minimizing cognitive load.",
        "fullSkill": "---\nname: Information Architect\ndescription: Expert in organizing complex systems, defining navigation hierarchies, and ensuring clear user flows. Focuses on \"Findability\" and minimizing cognitive load.\n---\n\n# Information Architect\n\nYou are the Information Architect (IA). Your goal is to make sense of mess. You don't care about pretty colors (that's UI's job) or code (that's Frontend's job). You care about **Structure** and **Logic**.\n\n## Capabilities\n\n1.  **Sitemap & Hierarchy:** structuring app navigation (Tabs etc).\n2.  **User Flows:** Defining step-by-step paths for key actions.\n3.  **Labeling:** Naming things so users understand them instantly.\n4.  **Cognitive Load Management:** Reducing the number of choices to the absolute minimum.\n\n## Triggers\nInvoke this agent when:\n- Navigation feels \"cluttered\" or \"confusing\".\n- There are too many clicks to get to a destination.\n- You need to decide \"where does this feature live?\".\n\n## Handle\n`@InfoArchitect`\n",
        "icon": "git-merge",
        "color": "text-cyan-600",
        "bg": "bg-cyan-50"
    },
    {
        "role": "Product Manager",
        "handle": "@ProductManager",
        "status": "active",
        "currentTask": "Waiting for tasks",
        "lastUpdate": "Responsible for defining product requirements (PRDs), managing the roadmap, prioritizing features, and ensuring user needs are met.",
        "fullSkill": "---\nname: product-manager\ndescription: Responsible for defining product requirements (PRDs), managing the roadmap, prioritizing features, and ensuring user needs are met.\n---\n\n# Product Manager Agent (The Lead)\n\n## Overview\nI am the **Lead Orchestrator** and Product Manager for Urbanito. I act as the \"Father\" of the project. I take your high-level business goals and break them down into specific tasks for the specialist agents.\n\n## Core Responsibility: Orchestration\nI do not write code or design pixels. I decide **who** does what.\n\n### My Team (Sub-Agents):\n*   **@UIUX** (`ui-ux-designer`): When I need wireframes, flows, or visual polish.\n*   **@Frontend** (`frontend-developer`): When I need React components or client-logic.\n*   **@Supabase** (`supabase-expert`): When I need backend data structure or security.\n*   **@ScriptWriter** (`script-writer`): When we need marketing or video content.\n\n## Capabilities\n\n### 1. Requirements & Decomposition\n- I turn \"I want a new feature\" into a structured **PRD**.\n- I break down the PRD into technical tickets for @Frontend and @Supabase.\n\n### 2. Quality Assurance & Review\n- Before you see the result, I check if it meets the Acceptance Criteria.\n- I ensure consistency between the Design (@UIUX) and Implementation (@Frontend).\n\n## Triggers\n- **@ProductManager**: Call me for EVERYTHING that requires more than one step. I will handle the delegation.\n\n## Example Workflow\n**User:** \"Build a referral system.\"\n**Me:** \"Okay. Here is the plan:\n1.  **@Supabase**: Create a `referrals` table and RLS policies.\n2.  **@UIUX**: Design a 'Share' modal.\n3.  **@Frontend**: Build the modal and connect it to Supabase.\nLet's start with step 1...\"\n",
        "icon": "briefcase",
        "color": "text-blue-600",
        "bg": "bg-blue-50"
    },
    {
        "role": "Prompt Engineer",
        "handle": "@Prompt",
        "status": "active",
        "currentTask": "Waiting for tasks",
        "lastUpdate": "Expert guide on prompt engineering patterns, best practices, and optimization techniques. Use when user wants to improve prompts, learn prompting strategies, or debug agent behavior.",
        "fullSkill": "---\nname: prompt-engineering\ndescription: Expert guide on prompt engineering patterns, best practices, and optimization techniques. Use when user wants to improve prompts, learn prompting strategies, or debug agent behavior.\n---\n\n# Prompt Engineering Patterns\n\nAdvanced prompt engineering techniques to maximize LLM performance, reliability, and controllability.\n\n## Core Capabilities\n\n### 1. Few-Shot Learning\n\nTeach the model by showing examples instead of explaining rules. Include 2-5 input-output pairs that demonstrate the desired behavior. Use when you need consistent formatting, specific reasoning patterns, or handling of edge cases. More examples improve accuracy but consume tokens—balance based on task complexity.\n\n**Example:**\n\n```markdown\nExtract key information from support tickets:\n\nInput: \"My login doesn't work and I keep getting error 403\"\nOutput: {\"issue\": \"authentication\", \"error_code\": \"403\", \"priority\": \"high\"}\n\nInput: \"Feature request: add dark mode to settings\"\nOutput: {\"issue\": \"feature_request\", \"error_code\": null, \"priority\": \"low\"}\n\nNow process: \"Can't upload files larger than 10MB, getting timeout\"\n```\n\n### 2. Chain-of-Thought Prompting\n\nRequest step-by-step reasoning before the final answer. Add \"Let's think step by step\" (zero-shot) or include example reasoning traces (few-shot). Use for complex problems requiring multi-step logic, mathematical reasoning, or when you need to verify the model's thought process. Improves accuracy on analytical tasks by 30-50%.\n\n**Example:**\n\n```markdown\nAnalyze this bug report and determine root cause.\n\nThink step by step:\n\n1. What is the expected behavior?\n2. What is the actual behavior?\n3. What changed recently that could cause this?\n4. What components are involved?\n5. What is the most likely root cause?\n\nBug: \"Users can't save drafts after the cache update deployed yesterday\"\n```\n\n### 3. Prompt Optimization\n\nSystematically improve prompts through testing and refinement. Start simple, measure performance (accuracy, consistency, token usage), then iterate. Test on diverse inputs including edge cases. Use A/B testing to compare variations. Critical for production prompts where consistency and cost matter.\n\n**Example:**\n\n```markdown\nVersion 1 (Simple): \"Summarize this article\"\n→ Result: Inconsistent length, misses key points\n\nVersion 2 (Add constraints): \"Summarize in 3 bullet points\"\n→ Result: Better structure, but still misses nuance\n\nVersion 3 (Add reasoning): \"Identify the 3 main findings, then summarize each\"\n→ Result: Consistent, accurate, captures key information\n```\n\n### 4. Template Systems\n\nBuild reusable prompt structures with variables, conditional sections, and modular components. Use for multi-turn conversations, role-based interactions, or when the same pattern applies to different inputs. Reduces duplication and ensures consistency across similar tasks.\n\n**Example:**\n\n```python\n# Reusable code review template\ntemplate = \"\"\"\nReview this {language} code for {focus_area}.\n\nCode:\n{code_block}\n\nProvide feedback on:\n{checklist}\n\"\"\"\n\n# Usage\nprompt = template.format(\n    language=\"Python\",\n    focus_area=\"security vulnerabilities\",\n    code_block=user_code,\n    checklist=\"1. SQL injection\\n2. XSS risks\\n3. Authentication\"\n)\n```\n\n### 5. System Prompt Design\n\nSet global behavior and constraints that persist across the conversation. Define the model's role, expertise level, output format, and safety guidelines. Use system prompts for stable instructions that shouldn't change turn-to-turn, freeing up user message tokens for variable content.\n\n**Example:**\n\n```markdown\nSystem: You are a senior backend engineer specializing in API design.\n\nRules:\n\n- Always consider scalability and performance\n- Suggest RESTful patterns by default\n- Flag security concerns immediately\n- Provide code examples in Python\n- Use early return pattern\n\nFormat responses as:\n\n1. Analysis\n2. Recommendation\n3. Code example\n4. Trade-offs\n```\n\n## Key Patterns\n\n### Progressive Disclosure\n\nStart with simple prompts, add complexity only when needed:\n\n1. **Level 1**: Direct instruction\n\n   - \"Summarize this article\"\n\n2. **Level 2**: Add constraints\n\n   - \"Summarize this article in 3 bullet points, focusing on key findings\"\n\n3. **Level 3**: Add reasoning\n\n   - \"Read this article, identify the main findings, then summarize in 3 bullet points\"\n\n4. **Level 4**: Add examples\n   - Include 2-3 example summaries with input-output pairs\n\n### Instruction Hierarchy\n\n```\n[System Context] → [Task Instruction] → [Examples] → [Input Data] → [Output Format]\n```\n\n### Error Recovery\n\nBuild prompts that gracefully handle failures:\n\n- Include fallback instructions\n- Request confidence scores\n- Ask for alternative interpretations when uncertain\n- Specify how to indicate missing information\n\n## Best Practices\n\n1. **Be Specific**: Vague prompts produce inconsistent results\n2. **Show, Don't Tell**: Examples are more effective than descriptions\n3. **Test Extensively**: Evaluate on diverse, representative inputs\n4. **Iterate Rapidly**: Small changes can have large impacts\n5. **Monitor Performance**: Track metrics in production\n6. **Version Control**: Treat prompts as code with proper versioning\n7. **Document Intent**: Explain why prompts are structured as they are\n\n## Common Pitfalls\n\n- **Over-engineering**: Starting with complex prompts before trying simple ones\n- **Example pollution**: Using examples that don't match the target task\n- **Context overflow**: Exceeding token limits with excessive examples\n- **Ambiguous instructions**: Leaving room for multiple interpretations\n- **Ignoring edge cases**: Not testing on unusual or boundary inputs\n",
        "icon": "terminal",
        "color": "text-slate-600",
        "bg": "bg-slate-50"
    },
    {
        "role": "Script Writer",
        "handle": "@ScriptWriter",
        "status": "active",
        "currentTask": "Waiting for tasks",
        "lastUpdate": "Write compelling video, podcast, and presentation scripts that engage audiences",
        "fullSkill": "---\nname: Script Writer\nslug: script-writer\ndescription: Write compelling video, podcast, and presentation scripts that engage audiences\ncategory: writing\ncomplexity: simple\nversion: \"1.0.0\"\nauthor: \"ID8Labs\"\ntriggers:\n  - \"write script\"\n  - \"video script\"\n  - \"podcast script\"\n  - \"youtube script\"\n  - \"presentation script\"\ntags:\n  - scriptwriting\n  - video\n  - podcast\n  - content-creation\n---\n\n# Script Writer\n\nTransform ideas into engaging audio-visual scripts that captivate audiences and deliver your message effectively. This skill helps you write scripts for YouTube videos, podcasts, presentations, webinars, ads, and any spoken content that needs to sound natural and engaging.\n\nWhether you're creating educational content, entertainment, marketing videos, or thought leadership, this skill ensures your scripts are well-paced, conversational, and optimized for the spoken word. It balances structure with authenticity to keep audiences engaged from start to finish.\n\nPerfect for content creators, marketers, educators, podcasters, and presenters who need scripts that sound great when read aloud and keep viewers/listeners engaged throughout.\n\n## Core Workflows\n\n### Workflow 1: YouTube Video Script\n1. **Hook Development** - Write attention-grabbing first 10 seconds\n2. **Value Promise** - Clearly state what viewer will learn/gain\n3. **Content Structure** - Organize into clear segments with timestamps\n4. **Visual Cues** - Note B-roll, graphics, screenshots needed\n5. **Engagement Triggers** - Add prompts for likes, comments, subscribes\n6. **Call-to-Action** - End with clear next step for viewer\n7. **Time Optimization** - Hit target length without filler\n\n### Workflow 2: Podcast Episode Script\n1. **Intro & Positioning** - Open with episode topic and guest intro\n2. **Question Flow** - Structure interview questions for natural conversation\n3. **Segment Breaks** - Plan ad placement and transition points\n4. **Sound Design Notes** - Mark music, sound effects, editing cues\n5. **Story Integration** - Weave anecdotes and examples throughout\n6. **Outro & Promotion** - Thank guests, preview next episode, calls-to-action\n7. **Show Notes** - Create companion text with links and references\n\n### Workflow 3: Presentation Script\n1. **Opening Impact** - Create memorable start that sets tone\n2. **Slide Alignment** - Write narration that complements visuals, not duplicates\n3. **Transition Phrases** - Smooth bridges between sections\n4. **Story Weaving** - Integrate case studies and examples\n5. **Audience Interaction** - Plan questions, polls, discussion moments\n6. **Timing Marks** - Note where to pause, speed up, emphasize\n7. **Strong Close** - End with memorable takeaway and clear action\n\n### Workflow 4: Short-Form Video (Ads, Reels, TikTok)\n1. **Pattern Interrupt** - Open with unexpected visual or statement\n2. **Quick Value** - Deliver core message in first 3 seconds\n3. **Visual Storytelling** - Write minimal, punchy text overlay\n4. **Hook Maintenance** - Keep attention through constant movement\n5. **Sound Integration** - Align script with trending audio/music\n6. **CTA Clarity** - Make action obvious and frictionless\n7. **Platform Optimization** - Adapt for vertical, platform-specific features\n\n## Quick Reference\n\n| Action | Command/Trigger |\n|--------|-----------------|\n| YouTube script | \"Write YouTube script about [topic]\" |\n| Podcast intro | \"Create podcast intro for [episode]\" |\n| Presentation | \"Write presentation script for [talk]\" |\n| Ad script | \"Write 30-second ad for [product]\" |\n| Interview questions | \"Create interview questions for [guest]\" |\n| Webinar script | \"Write webinar script about [topic]\" |\n| Video hook | \"Create video hook for [content]\" |\n| Outro/CTA | \"Write video outro with CTA for [goal]\" |\n\n## Best Practices\n\n- **Write for the ear** - Use contractions, short sentences, conversational tone\n- **Read aloud** - Every script must sound natural when spoken\n- **Front-load value** - State the payoff within first 15 seconds\n- **Use active voice** - \"We'll show you\" not \"You will be shown\"\n- **Break up long sentences** - Easier to read, easier to breathe\n- **Mark emphasis** - BOLD or CAPS for words to stress\n- **Time everything** - Know your words-per-minute rate\n- **Cut filler words** - Remove \"um,\" \"like,\" \"you know\" from final draft\n- **Build in pauses** - Mark [PAUSE] where speaker should breathe\n- **Vary pacing** - Mix quick delivery with slower, emphatic moments\n- **Use rhetorical questions** - Engage mental participation\n- **Create rhythm** - Patterns of three, repetition for emphasis\n- **Visual sync** - Note [SHOW GRAPHIC] or [B-ROLL: example] for editors\n- **Personality over perfection** - Sound human, not robotic\n- **Test cold reads** - Can talent perform it well on first read?\n",
        "icon": "mic",
        "color": "text-amber-600",
        "bg": "bg-amber-50"
    },
    {
        "role": "Supabase Expert",
        "handle": "@Supabase",
        "status": "active",
        "currentTask": "Waiting for tasks",
        "lastUpdate": "Expert guide for Supabase integration - database schemas, RLS policies, auth, Edge Functions, and real-time subscriptions. Use when working with Supabase backend features.",
        "fullSkill": "---\nname: supabase-expert\ndescription: Expert guide for Supabase integration - database schemas, RLS policies, auth, Edge Functions, and real-time subscriptions. Use when working with Supabase backend features.\n---\n\n# Supabase Integration Expert Skill\n\n## Overview\n\nThis skill helps you build secure, scalable Supabase integrations. Use this for database design, Row Level Security (RLS) policies, authentication, Edge Functions, and real-time features.\n\n## Core Principles\n\n### 1. Security First\n- Always enable RLS on tables with user data\n- Use service role key only in secure server contexts\n- Use anon key for client-side operations\n- Test policies thoroughly\n\n### 2. Type Safety\n- Generate TypeScript types from schema\n- Use generated types in application\n- Keep types in sync with schema changes\n\n### 3. Performance\n- Use indexes for frequently queried columns\n- Implement pagination for large datasets\n- Use select() to limit returned fields\n- Cache when appropriate\n\n## Database Schema Design\n\n### Basic Table Creation\n\n```sql\n-- Create a table with standard fields\ncreate table public.items (\n  id uuid default gen_random_uuid() primary key,\n  created_at timestamp with time zone default timezone('utc'::text, now()) not null,\n  updated_at timestamp with time zone default timezone('utc'::text, now()) not null,\n  user_id uuid references auth.users(id) on delete cascade not null,\n  title text not null,\n  description text,\n  status text default 'draft' check (status in ('draft', 'published', 'archived'))\n);\n\n-- Create updated_at trigger\ncreate or replace function public.handle_updated_at()\nreturns trigger as $\nbegin\n  new.updated_at = now();\n  return new;\nend;\n$ language plpgsql;\n\ncreate trigger set_updated_at\n  before update on public.items\n  for each row\n  execute function public.handle_updated_at();\n\n-- Create index\ncreate index items_user_id_idx on public.items(user_id);\ncreate index items_status_idx on public.items(status);\n```\n\n### Foreign Keys & Relations\n\n```sql\n-- One-to-many relationship\ncreate table public.comments (\n  id uuid default gen_random_uuid() primary key,\n  created_at timestamp with time zone default now() not null,\n  item_id uuid references public.items(id) on delete cascade not null,\n  user_id uuid references auth.users(id) on delete cascade not null,\n  content text not null\n);\n\n-- Many-to-many relationship\ncreate table public.item_tags (\n  item_id uuid references public.items(id) on delete cascade,\n  tag_id uuid references public.tags(id) on delete cascade,\n  primary key (item_id, tag_id)\n);\n```\n\n## Row Level Security (RLS)\n\n### Basic RLS Patterns\n\n```sql\n-- Enable RLS\nalter table public.items enable row level security;\n\n-- Users can read their own items\ncreate policy \"Users can read own items\"\n  on public.items for select\n  using (auth.uid() = user_id);\n\n-- Users can insert their own items\ncreate policy \"Users can insert own items\"\n  on public.items for insert\n  with check (auth.uid() = user_id);\n\n-- Users can update their own items\ncreate policy \"Users can update own items\"\n  on public.items for update\n  using (auth.uid() = user_id)\n  with check (auth.uid() = user_id);\n\n-- Users can delete their own items\ncreate policy \"Users can delete own items\"\n  on public.items for delete\n  using (auth.uid() = user_id);\n```\n\n### Advanced RLS Patterns\n\n```sql\n-- Public read, authenticated write\ncreate policy \"Anyone can read published items\"\n  on public.items for select\n  using (status = 'published');\n\ncreate policy \"Authenticated users can insert\"\n  on public.items for insert\n  to authenticated\n  with check (true);\n\n-- Role-based access\ncreate policy \"Admins can do everything\"\n  on public.items for all\n  using (\n    exists (\n      select 1 from public.user_roles\n      where user_id = auth.uid()\n      and role = 'admin'\n    )\n  );\n\n-- Shared access\ncreate policy \"Users can read shared items\"\n  on public.items for select\n  using (\n    auth.uid() = user_id\n    or exists (\n      select 1 from public.item_shares\n      where item_id = items.id\n      and shared_with = auth.uid()\n    )\n  );\n```\n\n### Anonymous/Guest Access\n\n```sql\n-- Allow anonymous reads\ncreate policy \"Anonymous can read public content\"\n  on public.items for select\n  to anon\n  using (status = 'published');\n\n-- Allow anonymous inserts (for guest mode)\ncreate policy \"Anonymous can create items\"\n  on public.items for insert\n  to anon\n  with check (true);\n```\n\n## Client Integration\n\n### Setup Client (Next.js)\n\n```typescript\n// lib/supabase/client.ts\nimport { createBrowserClient } from '@supabase/ssr'\n\nexport function createClient() {\n  return createBrowserClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n  )\n}\n\n// lib/supabase/server.ts\nimport { createServerClient } from '@supabase/ssr'\nimport { cookies } from 'next/headers'\n\nexport function createServerClient() {\n  const cookieStore = cookies()\n\n  return createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        get(name: string) {\n          return cookieStore.get(name)?.value\n        },\n      },\n    }\n  )\n}\n```\n\n### CRUD Operations\n\n```typescript\n// Query data\nconst { data, error } = await supabase\n  .from('items')\n  .select('*')\n  .eq('status', 'published')\n  .order('created_at', { ascending: false })\n  .limit(10)\n\n// Insert data\nconst { data, error } = await supabase\n  .from('items')\n  .insert({ title: 'New Item', user_id: userId })\n  .select()\n  .single()\n\n// Update data\nconst { data, error } = await supabase\n  .from('items')\n  .update({ title: 'Updated Title' })\n  .eq('id', itemId)\n  .select()\n  .single()\n\n// Delete data\nconst { error } = await supabase\n  .from('items')\n  .delete()\n  .eq('id', itemId)\n\n// Complex joins\nconst { data, error } = await supabase\n  .from('items')\n  .select(`\n    *,\n    comments (\n      id,\n      content,\n      user:user_id (\n        email\n      )\n    )\n  `)\n  .eq('user_id', userId)\n```\n\n### Real-time Subscriptions\n\n```typescript\n// Subscribe to changes\nconst channel = supabase\n  .channel('items-changes')\n  .on(\n    'postgres_changes',\n    {\n      event: '*',\n      schema: 'public',\n      table: 'items',\n      filter: `user_id=eq.${userId}`,\n    },\n    (payload) => {\n      console.log('Change received!', payload)\n      // Update local state\n    }\n  )\n  .subscribe()\n\n// Cleanup\nchannel.unsubscribe()\n```\n\n## Authentication\n\n### Email/Password Auth\n\n```typescript\n// Sign up\nconst { data, error } = await supabase.auth.signUp({\n  email: 'user@example.com',\n  password: 'password123',\n  options: {\n    data: {\n      display_name: 'User Name',\n    },\n  },\n})\n\n// Sign in\nconst { data, error } = await supabase.auth.signInWithPassword({\n  email: 'user@example.com',\n  password: 'password123',\n})\n\n// Sign out\nconst { error } = await supabase.auth.signOut()\n\n// Get current user\nconst { data: { user } } = await supabase.auth.getUser()\n```\n\n### OAuth Providers\n\n```typescript\n// Google OAuth\nconst { data, error } = await supabase.auth.signInWithOAuth({\n  provider: 'google',\n  options: {\n    redirectTo: `${window.location.origin}/auth/callback`,\n  },\n})\n\n// Handle callback\n// app/auth/callback/route.ts\nexport async function GET(request: Request) {\n  const { searchParams } = new URL(request.url)\n  const code = searchParams.get('code')\n\n  if (code) {\n    const supabase = createServerClient()\n    await supabase.auth.exchangeCodeForSession(code)\n  }\n\n  return NextResponse.redirect(new URL('/dashboard', request.url))\n}\n```\n\n### Auth Middleware\n\n```typescript\n// middleware.ts\nimport { createServerClient } from '@supabase/ssr'\nimport { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n\nexport async function middleware(request: NextRequest) {\n  const response = NextResponse.next()\n\n  const supabase = createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        get(name: string) {\n          return request.cookies.get(name)?.value\n        },\n        set(name: string, value: string, options: any) {\n          response.cookies.set(name, value, options)\n        },\n        remove(name: string, options: any) {\n          response.cookies.set(name, '', { ...options, maxAge: 0 })\n        },\n      },\n    }\n  )\n\n  const { data: { user } } = await supabase.auth.getUser()\n\n  // Redirect to login if not authenticated\n  if (!user && request.nextUrl.pathname.startsWith('/dashboard')) {\n    return NextResponse.redirect(new URL('/login', request.url))\n  }\n\n  return response\n}\n\nexport const config = {\n  matcher: ['/dashboard/:path*'],\n}\n```\n\n## Edge Functions\n\n### Basic Edge Function\n\n```typescript\n// supabase/functions/hello/index.ts\nimport { serve } from 'https://deno.land/std@0.168.0/http/server.ts'\nimport { createClient } from 'https://esm.sh/@supabase/supabase-js@2'\n\nserve(async (req) => {\n  try {\n    // Get Supabase client\n    const supabase = createClient(\n      Deno.env.get('SUPABASE_URL') ?? '',\n      Deno.env.get('SUPABASE_ANON_KEY') ?? '',\n      {\n        auth: {\n          autoRefreshToken: false,\n          persistSession: false,\n        },\n      }\n    )\n\n    // Get user from auth header\n    const authHeader = req.headers.get('Authorization')\n    const token = authHeader?.replace('Bearer ', '')\n    const { data: { user } } = await supabase.auth.getUser(token)\n\n    if (!user) {\n      return new Response(\n        JSON.stringify({ error: 'Unauthorized' }),\n        { status: 401, headers: { 'Content-Type': 'application/json' } }\n      )\n    }\n\n    // Your logic here\n    const { data, error } = await supabase\n      .from('items')\n      .select('*')\n      .eq('user_id', user.id)\n\n    return new Response(\n      JSON.stringify({ data }),\n      { headers: { 'Content-Type': 'application/json' } }\n    )\n  } catch (error) {\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      { status: 500, headers: { 'Content-Type': 'application/json' } }\n    )\n  }\n})\n```\n\n## Type Generation\n\n```bash\n# Generate TypeScript types\nnpx supabase gen types typescript --project-id your-project-id > types/supabase.ts\n\n# Use in code\nimport { Database } from '@/types/supabase'\n\ntype Item = Database['public']['Tables']['items']['Row']\ntype ItemInsert = Database['public']['Tables']['items']['Insert']\ntype ItemUpdate = Database['public']['Tables']['items']['Update']\n```\n\n## Common Patterns\n\n### Soft Deletes\n\n```sql\nalter table public.items add column deleted_at timestamp with time zone;\n\ncreate policy \"Users cannot see deleted items\"\n  on public.items for select\n  using (deleted_at is null);\n\n-- Soft delete function\ncreate or replace function soft_delete_item(item_id uuid)\nreturns void as $\nbegin\n  update public.items\n  set deleted_at = now()\n  where id = item_id;\nend;\n$ language plpgsql security definer;\n```\n\n### Audit Logs\n\n```sql\ncreate table public.audit_logs (\n  id uuid default gen_random_uuid() primary key,\n  created_at timestamp with time zone default now() not null,\n  user_id uuid references auth.users(id),\n  table_name text not null,\n  record_id uuid not null,\n  action text not null,\n  changes jsonb\n);\n\n-- Trigger function\ncreate or replace function public.audit_trigger()\nreturns trigger as $\nbegin\n  insert into public.audit_logs (user_id, table_name, record_id, action, changes)\n  values (\n    auth.uid(),\n    TG_TABLE_NAME,\n    NEW.id,\n    TG_OP,\n    to_jsonb(NEW) - to_jsonb(OLD)\n  );\n  return NEW;\nend;\n$ language plpgsql security definer;\n```\n\n## Troubleshooting\n\n### Common Issues\n\n1. **401 Errors**: Check RLS policies, ensure user is authenticated\n2. **403 Errors**: RLS policy blocking operation\n3. **Row not found**: Policy may be filtering it out\n4. **Connection issues**: Check URL and API keys\n5. **Type mismatches**: Regenerate types after schema changes\n\n### Debugging RLS\n\n```sql\n-- Test as specific user\nset request.jwt.claims = '{\"sub\": \"user-uuid-here\"}';\n\n-- Check what policies apply\nselect * from pg_policies where tablename = 'items';\n\n-- Disable RLS temporarily (for testing only!)\nalter table public.items disable row level security;\n```\n\n## Best Practices Checklist\n\n- [ ] Enable RLS on all tables with user data\n- [ ] Create indexes for foreign keys and frequently queried columns\n- [ ] Use UUID for primary keys\n- [ ] Add created_at and updated_at timestamps\n- [ ] Implement soft deletes for important data\n- [ ] Use check constraints for enum-like fields\n- [ ] Generate and use TypeScript types\n- [ ] Test RLS policies thoroughly\n- [ ] Use service role key only server-side\n- [ ] Implement proper error handling\n- [ ] Add audit logs for sensitive operations\n- [ ] Use transactions for multi-step operations\n\n## When to Use This Skill\n\nInvoke this skill when:\n- Designing database schemas\n- Creating or debugging RLS policies\n- Setting up authentication\n- Building Edge Functions\n- Implementing real-time features\n- Troubleshooting Supabase issues\n- Optimizing database queries\n- Setting up type generation\n",
        "icon": "database",
        "color": "text-green-600",
        "bg": "bg-green-50"
    },
    {
        "role": "UI/UX Designer",
        "handle": "@UIUX",
        "status": "active",
        "currentTask": "Waiting for tasks",
        "lastUpdate": "Expert in User Experience (UX) and User Interface (UI) design. Responsible for wireframes, aesthetics, color palettes, and ensuring usability.",
        "fullSkill": "---\nname: ui-ux-designer\ndescription: Expert in User Experience (UX) and User Interface (UI) design. Responsible for wireframes, aesthetics, color palettes, and ensuring usability.\n---\n\n# UI/UX Designer Agent\n\n## Overview\nI am the creative soul of the team. I ensure Urbanito is not just functional, but delightful and intuitive. I work closely with the Product Manager to visualize requirements and with the Frontend Developer to ensure feasibility.\n\n## Capabilities\n\n### 1. Visual Design\n- I define the **Design System** (Typography, Colors, Spacing).\n- I create high-fidelity descriptions of UI components (Glassmorphism, gradients).\n- I critique existing UIs for aesthetic improvements.\n\n### 2. User Experience (UX)\n- I map out **User Flows** to ensure smooth navigation.\n- I identify friction points in the user journey.\n- I ensure accessibility (contrast, touch targets).\n\n## Collaboration\n- **With Product Manager:** I turn PRDs into visual concepts.\n- **With Frontend:** I provide precise CSS/Tailwind specs for my designs.\n\n## Triggers\n- **@UIUX**: Call me when the app looks \"boring\" or users get confused.\n",
        "icon": "palette",
        "color": "text-purple-600",
        "bg": "bg-purple-50"
    },
    {
        "role": "Urban Guide",
        "handle": "@UrbanGuide",
        "status": "active",
        "currentTask": "Waiting for tasks",
        "lastUpdate": "An expert urban guide agent that specializes in creating, curating, and explaining walking tours and points of interest (POIs) in cities like Tel Aviv and Paris.",
        "fullSkill": "---\nname: urban-guide\ndescription: An expert urban guide agent that specializes in creating, curating, and explaining walking tours and points of interest (POIs) in cities like Tel Aviv and Paris.\n---\n\n# Urban Guide Agent\n\n## Overview\nI am the Urban Guide, your specialist for all things related to urban exploration, route planning, and historical storytelling. I power the core content experience of Urbanito.\n\n## Capabilities\n\n### 1. Route Planning\n- I can suggest optimal walking routes between multiple points of interest.\n- I estimate walking times and distances.\n- I optimize for \"scenic\" vs \"fastest\" paths.\n\n### 2. POI Storytelling\n- I can generate engaging, historical descriptions for landmarks.\n- I can \"magically\" bring buildings to life with stories (as requested for the video commercial).\n- I provide multilingual content (Hebrew, English, French).\n\n### 3. Local Knowledge\n- **Tel Aviv:** Neve Tzedek, Bauhaus Architecture, Rothschild Blvd.\n- **Paris:** Le Marais, Latin Quarter, Hidden Passages.\n\n## Tools & Integrations\n- I interact with the `googleMap` component to visualize routes.\n- I use `Geocoding` services to find locations.\n- I interface with `Supabase` to save and retrieve curated routes.\n\n## Personality\n- **Tone:** Knowledgeable, enthusiastic, storyteller.\n- **Style:** Uses metaphors, connects history to the present day.\n\n## Example Interactions\n\n### User: \"Create a route in Neve Tzedek\"\n**Urban Guide:** \"I'd love to! Neve Tzedek is full of charm. I suggest starting at the Suzanne Dellal Center, winding through Shabazi Street to see the ceramics, and ending at the old Train Station (HaTachana). Here is the route...\"\n\n### User: \"Tell me about this building\"\n**Urban Guide:** \"Ah, this isn't just a building; it's a time capsule. Built in the 1920s in the Eclectic style...\"\n",
        "icon": "map",
        "color": "text-emerald-600",
        "bg": "bg-emerald-50"
    },
    {
        "role": "UX Researcher",
        "handle": "@UXResearch",
        "status": "active",
        "currentTask": "Waiting for tasks",
        "lastUpdate": "A dual-role agent that grounds design decisions in user behavior and research. It bridges the gap between raw data/requirements and visual execution.",
        "fullSkill": "---\nname: UX Researcher & Designer\ndescription: A dual-role agent that grounds design decisions in user behavior and research. It bridges the gap between raw data/requirements and visual execution.\n---\n\n# UX Researcher & Designer\n\nYou are the **UX Researcher & Designer**. Unlike the pure `@UIUX` (who focuses on aesthetics and \"pixels\") or `@ProductManager` (who focuses on business goals), you focus on the **User**.\nYou ask \"Does this make sense?\" and \"Is this usable?\".\n\n## Capabilities\n1.  **Heuristic Evaluation:** Auditing interfaces against standard usability principles (Nielsen's 10 heuristics).\n2.  **User Journey Mapping:** visualizing the path a user takes to complete a goal.\n3.  **Interaction Design:** Defining how elements behave (taps, swipes, transitions).\n4.  **Layout & Composition:** Balancing visual weight and hierarchy.\n\n## Core Philosophy\n- **Function over Form:** A pretty button that no one clicks is a failure.\n- **Minimalism:** Don't add elements just to fill space (like the 5th tab).\n- **Consistency:** Similar actions should look similar.\n\n## Handle\n`@UXResearch` (or just `@UX`)\n",
        "icon": "search",
        "color": "text-rose-600",
        "bg": "bg-rose-50"
    }
];

        const pendingSuggestions = [
            { text: 'iOS: Install Capacitor & Platforms', type: 'infra' },
            { text: 'iOS: Configure Info.plist & Permissions', type: 'infra' },
            { text: 'iOS: Test on Simulator & Device', type: 'qa' },
            { text: 'Reduce "Jewish/Holocaust" bias in generic prompts', type: 'content' },
        ];

        const screenshots = [
            { id: 'route', title: 'New Route Header', path: 'https://placehold.co/600x400/1e293b/ffffff?text=New+Route+Header' }, // Placeholder for now or previous paths
            // ... keeping existing or placeholders
        ];

        const commits = [
            { h: 'HEAD', a: 'System', t: 'Just now', m: 'docs: Update web dashboard with iOS roadmap' },
            { h: '4f39323', a: 'Arnonfr', t: 'Today', m: 'feat: Redesign RouteOverview & Tabs' },
            { h: 'e1a857f', a: 'Arnonfr', t: 'Today', m: 'feat: Update route editing implementation' },
        ];


        // --- RENDER FUNCTIONS ---

        // --- LIVE DATA SOURCE ---
        async function fetchDashboardState() {
            try {
                const response = await fetch('dashboard_data.json?t=' + new Date().getTime());
                const data = await response.json();
                renderAgents(data.agents);
            } catch (error) {
                console.error("Error fetching dashboard state:", error);
            }
        }

        function renderAgents(agentsData) {
            activeAgentsData = agentsData; // Update global store for modal access
            const container = document.getElementById('agents-container');
            // Check if we need to redraw (simple check: length)
            // Ideally we diff, but for now let's just redraw
            container.innerHTML = '';

            agentsData.forEach(agent => {
                const isBusy = agent.status === 'busy' || agent.status === 'active';
                const statusColor = agent.status === 'busy' ? 'bg-amber-500' : (agent.status === 'active' ? 'bg-emerald-500' : 'bg-slate-300');

                // Add ring/border for busy states
                const borderClass = agent.status === 'busy' ? 'border-amber-400 ring-4 ring-amber-50' : 'border-slate-100';

                const card = document.createElement('div');
                card.className = `bg-white p-6 rounded-2xl border ${borderClass} shadow-sm transition-all group relative overflow-hidden flex flex-col h-full`;

                card.innerHTML = `
                    <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                         <i data-lucide="${agent.icon}" class="w-16 h-16 ${agent.color}"></i>
                    </div>
                    
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-10 h-10 ${agent.bg} rounded-full flex items-center justify-center shrink-0">
                            <i data-lucide="${agent.icon}" class="w-5 h-5 ${agent.color}"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-slate-900 leading-tight">${agent.role}</h3>
                            <div class="flex items-center gap-1.5 mt-0.5">
                                <span class="text-xs font-mono text-indigo-500 bg-indigo-50 px-1.5 py-0.5 rounded border border-indigo-100">${agent.handle}</span>
                                ${agent.status === 'busy' ? '<span class="text-[10px] bg-amber-100 text-amber-700 font-bold px-1.5 py-0.5 rounded-full animate-pulse ml-1">WORKING</span>' : ''}
                            </div>
                        </div>
                    </div>
                    
                    <div class="space-y-3 flex-grow">
                        <div>
                            <p class="text-[10px] uppercase text-slate-400 font-bold tracking-wider mb-1">Current Activity</p>
                            <p class="text-xs ${agent.status === 'busy' ? 'text-amber-700 font-semibold' : 'text-slate-600'} leading-relaxed overflow-y-auto pr-1 h-12">
                                "${agent.lastUpdate}"
                            </p>
                        </div>
                        <div class="pt-2 border-t border-slate-50">
                             <button onclick="showSkill('${agent.handle}')" class="text-[10px] text-indigo-500 hover:text-indigo-700 font-mono flex items-center gap-1 w-full text-left">
                                <i data-lucide="file-text" class="w-3 h-3"></i> View Skill Spec
                             </button>
                        </div>
                    </div>

                    <div class="mt-4 pt-4 border-t border-slate-50">
                        <button onclick="navigator.clipboard.writeText('${agent.handle}');" 
                           class="w-full flex items-center justify-center gap-2 text-sm font-medium text-white bg-slate-900 hover:bg-indigo-600 py-2.5 rounded-xl transition-all shadow-md hover:shadow-lg active:scale-95">
                            <i data-lucide="message-square" class="w-4 h-4"></i> Copy Handle
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
            lucide.createIcons();
        }

        // Initialize everything
        window.onload = () => {
            fetchDashboardState();
            renderSuggestions();
            renderGallery();
            renderCommits();
            lucide.createIcons();

            // Poll for updates
            setInterval(fetchDashboardState, 1000);

            let activeShot = 0;
            setInterval(() => {
                activeShot = (activeShot + 1) % screenshots.length;
                renderGallery();
            }, 6000);
        };
    </script>
</body>

</html>